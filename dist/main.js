(()=>{"use strict";class e{#e;#t;#n;#s;#i;#o;#r=[];#a;#d;#l;constructor(e){this.#l=e.id,this.#d=e.title,this.#e=e.albumArt,this.#t=e.artist,this.#s=e.releasedYear,this.#i=e.recommendation,this.#o=e.genre;for(let t of e.recommendedTracks)this.#r.push(t);this.#a=e}getId(){return this.#l}getTitle(){return this.#d}getAlbumArt(){return this.#e}getArtist(){return this.#t}getReleasedDate(){return this.#s}getRecommendation(){return this.#i}getGenre(){return this.#o}getTracks(){return this.#r}getItemObject(){return this.#a}}class t{#h;#c;#m;constructor(e){e&&(this.#c=e)}fetchData(){return fetch(this.#c)}}const n=["addedOrder","artist","recommendation","genre","releasedDate"];class s{#u;constructor(e){this.#u=e}sortBy(e,t){let n;switch(t){case"addedOrder":n=this.#f(e);break;case"artist":n=this.#p(e);break;case"releasedDate":n=this.#g(e);break;case"recommendation":n=this.#w(e)}return n}#f(e){return e.sort(((e,t)=>e.getId()-t.getId()))}#p(e){return e.sort(((e,t)=>{const n=e.getArtist(),s=t.getArtist();return n<s?-1:n>s?1:0}))}#g(e){return e.sort(((e,t)=>{const n=new Date(e.getReleasedDate()),s=new Date(t.getReleasedDate());return n<s?-1:n>s?1:0}))}#w(e){const t={strong:10,medium:5,weak:1};return e.sort(((e,n)=>{const s=e.getRecommendation(),i=n.getRecommendation();return t[s]-t[i]}))}}class i{#b;#C;#y;constructor(e,t){this.#b=e,this.#C=t,this.#y=new s(n)}renderItemListView(){this.#C.renderItems()}getItemList(){return this.#b.getItems()}getItemIterator(){return this.#b.createIterator()}sortItemsBy(e){const t=this.#y.sortBy(this.#b.getItems(),e);this.#b.setItems(t)}filterBy(e,t){let n,s=this.#b.getItems().slice();return"genre"===e&&(n=this.#I(s,t)),n}#I(e,t){return e.filter((e=>e.getGenre()==t))}searchItems(e){let t=[];const n=this.#b.createIterator();for(;n.hasMore();){const s=n.getNext();let i=!1;e in s.getTitle()&&(i=!0),i&&t.push(s)}return t}}class o{#x;constructor(e,t){if(e){let n=[];for(const s of e)n.push(new t(s));this.#x=n}}getDeserialized(){if(this.#x)return this.#x}}class r{#T;#R;constructor(e,t){this.#R=t,this.#T=e}getCollectionName(){return this.#T.collectionName}getCollectionDescription(){return this.#T.collectionDescription}displayView(){this.#R.display()}}class a{#d;#t;#o;#i;#k;#A;#S;constructor(e){this.#d=e.title,this.#t=e.artist,this.#o=e.genre,this.#i=e.recommendation,this.#k=e.releasedYear,this.#A=e.stream,this.#S=e.recommendedTracks}getTitleText(){return`Title: ${this.#d}`}getArtistText(){return`Artist: ${this.#t}`}getGenreText(){return`Genre: ${this.#o}`}getRecommendationText(){return`Recommendation: ${this.#i}`}getReleasedYearText(){return`Released Year: ${this.#k}`}getStreamList(){return Object.entries(this.#A)}getRecommendedTracks(){return this.#S.map((e=>[`${e.number}. ${e.title}`,e.playTime]))}}class d{#O;#L;constructor(e=null){this.#O=e}of(e){return this.#O=document.createElement(e),this}for(e){if(!this.#O)throw Error("No element before add label");return this.#O.setAttribute("for",e),this}hasAttributeOf(e,t){if(!this.#O)throw Error("No element before add attribute");return this.#O.setAttribute(e,t),this}hasIdAs(e){if(!this.#O)throw Error("No element before add id");return this.#O.setAttribute("id",e),this}hasNameOf(e){if(!this.#O)throw Error("No element before add name");return this.#O.setAttribute("name",e),this}hasValueOf(e){if(!this.#O)throw Error("No element before add value");return this.#O.setAttribute("value",e),this}inTheClassesOf(e){if(!this.#O)throw Error("No element before add class list");return this.#O.classList=e,this}styledAs(e){if(!this.#O)throw Error("No element before add style");this.#L=e;for(const[t,n]of Object.entries(e))this.#O.style[t]=n;return this}listeningOn(e,t){if(!this.#O)throw Error("No element before add event listner");return this.#O.addEventListener(e,t),this}hasTextOf(e){if(!this.#O)throw Error("No element before add text content");return this.#O.textContent=e,this}hasChildrenOf(e){if(!this.#O)throw Error("No element before add children");for(const t of e)this.#O.appendChild(t);return this}build(){return this.#O}}class l extends HTMLElement{#v;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML="\n    <style>\n        :host {\n            position: absolute;\n            display: block;\n            background-color: black;\n            width: 2px;\n            height: 90%;\n            top: 5%;\n            left: 50%;\n        }\n        @media (max-width: 500px) {\n            :host {\n                position: static;\n                display: block;\n                background-color: black;\n                width: 90%;\n                height: 2px;\n            }\n        }\n    </style>\n",this.#v=e,this.setAttribute("id","divider")}}customElements.define("section-divider",l);class h extends HTMLElement{#v;#d;#t;#k;#i;#D;#o;#S;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML="\n    <style>\n        :host {\n            z-index: 1;\n            display: none;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            grid-template-rows: 1fr;\n            grid-template-columns: 1fr 1fr;\n            background-color: white;\n            align-items: center;\n        }\n        #button-back {\n            position: absolute;\n            top: 2.5%;\n            left: 2.5%;\n            width: 5%;\n            height: 5%;\n            border: none;\n            background-color: transparent;\n            background-repeat: no-repeat;\n            cursor: pointer;\n        }\n        #section-info {\n            padding: 0 25%;\n        }\n        #section-info p {\n            font-weight: bolder;\n            font-size: .6rem;\n        }\n        #album-streams {\n            padding: 0;\n        }\n        #album-streams a {\n            font-size: .7rem;\n            text-decoration: none;\n            color: black;\n            border: 1px solid;\n            border-radius: 5px;\n            border-width: medium;\n            padding: 0.2rem;\n            box-shadow: 5px 5px black;\n        }\n        #section-info section #RT-title {\n            font-size: .8rem;\n            font-weight: bolder;\n            margin: 10px 0;\n        }\n        #album-recommendedTracks div {\n            font-size: .7rem;\n        }\n        #album-recommendedTracks div span:nth-child(2) {\n            padding-left: 2.5%;\n        }\n        #divider {\n            margin: 0 auto;\n        }\n        @media (max-width: 500px) {\n            :host {\n                width: 100vw;\n                height: 100%;\n                grid-template-columns: 1fr;\n                grid-template-rows: 1fr 0 1fr;\n                background-color: white;\n                align-items: center;\n            }\n        }\n    </style>\n",this.#v=e,this.hide=this.hide.bind(this),this.#E(),this.#B(),this.#M()}#E(){const e=(new d).of("button").hasIdAs("button-back").styledAs({backgroundImage:"url(./src/assets/images/icons/reshot-icon-angle-back-8E4DS2MACR.svg)"}).listeningOn("click",(()=>{this.#N(this.#S),this.#N(this.#D),this.#j(),this.hide()})).build();this.#v.appendChild(e)}#j(){document.querySelector("my-music-db").shadowRoot.querySelector("item-list").style.overflow="scroll"}#N(e){if(e)for(;e.lastChild;)e.removeChild(e.lastChild)}#B(){const e=[],t=(new d).of("p").hasIdAs("album-title").build();this.#d=t,e.push(t);const n=(new d).of("p").hasIdAs("album-artist").build();this.#t=n,e.push(n);const s=(new d).of("p").hasIdAs("album-genre").build();this.#o=s,e.push(s);const i=(new d).of("p").hasIdAs("album-recommendation").build();this.#i=i,e.push(i);const o=(new d).of("p").hasIdAs("album-releasedYear").build();this.#k=o,e.push(o);const r=(new d).of("ul").hasIdAs("album-streams").build();this.#D=r,e.push(r);const a=(new d).of("section").hasIdAs("album-recommendedTracks").build();this.#S=a,e.push(a);const l=(new d).of("section").hasIdAs("section-info").hasChildrenOf(e).build();this.#v.appendChild(l)}#V(e){const t=this.#v.querySelector("#section-info");if(this.#N(this.#D),this.#N(this.#S),t){const t=new a(e);this.#d.textContent=t.getTitleText(),this.#t.textContent=t.getArtistText(),this.#o.textContent=t.getGenreText(),this.#i.textContent=t.getRecommendationText(),this.#k.textContent=t.getReleasedYearText();for(const[e,n]of t.getStreamList()){const t=(new d).of("a").hasAttributeOf("href",n).hasTextOf(e).build();this.#D.appendChild(t)}const n=(new d).of("strong").hasTextOf("Recommended Tracks").build(),s=(new d).of("p").hasAttributeOf("id","RT-title").hasChildrenOf([n]).build();this.#S.appendChild(s);for(const[e,n]of t.getRecommendedTracks()){const t=(new d).of("span").hasTextOf(e).build(),s=(new d).of("span").hasTextOf(n).build(),i=(new d).of("div").hasChildrenOf([t,s]).build();this.#S.appendChild(i)}}}#M(){const e=new l;this.#v.appendChild(e)}#H(e){const t=this.#v.querySelector("#img-container");t&&t.addImg(e)}addSingleImg(e){e&&(e.setAttribute("id","img-container"),this.#v.appendChild(e))}hide(){this.style.display="none"}display(){this.style.display="grid"}showItem(e){this.#V(e.getItemObject()),this.#H(e.getAlbumArt()),this.display()}}customElements.define("item-detail",h);const c=e=>{const t=e.lastIndexOf(".");return[e.substring(0,t)+"-small.jpg 300w",e+" 600w"].join(", ")},m=()=>["(max-width: 500px) 300px","600px"].join(", ");class u extends HTMLElement{#z;#Y;constructor(e=""){super(),this.#z=e;const t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        #img-content {\n            aspect-ratio: 1 / 1;\n            box-shadow: 5px 5px black;\n            transition: .3s;\n        }\n        #img-content:hover {\n            scale: 1.3;\n        }\n        @media (max-width: 500px) {\n            #img-content {\n                width: 75vw;\n            }\n        }\n    </style>\n";const n=(new d).of("img").hasIdAs("img-content").build();this.#Y=n,t.appendChild(n)}addImg(e){this.#z=e,this.#Y.src=e,this.#Y.srcset=c(e),this.#Y.sizes=m()}}customElements.define("single-img",u);class f extends HTMLElement{#v;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML="\n    <style>\n        :host {\n            width: 100vw;\n            height: 100vh;\n            display: grid;\n            grid-template-rows: 1fr;\n            grid-template-columns: 1fr 1fr;\n        }\n        @media (max-width: 500px) {\n            :host {\n                width: 100vw;\n                height: auto;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n            }\n        }\n    </style>\n",this.#v=e}addChild(e){this.#v.appendChild(e)}}customElements.define("my-music-db",f);class p extends HTMLElement{#q;#v;constructor(){super();const e=this.attachShadow({mode:"open"});e.innerHTML="\n    <style>\n        :host {\n            display: block;\n            padding: 5%;\n        }\n    </style>\n",this.#v=e}addCollectionName(){const e=(new d).of("h1").hasIdAs("collection-name").hasTextOf(this.#q.getCollectionName()).build();this.#v.appendChild(e)}addCollectionDescription(){const e=(new d).of("p").hasIdAs("collection-description").hasTextOf(this.#q.getCollectionDescription()).build();this.#v.appendChild(e)}addController(e){this.#q=e}display(){this.style.display="block"}addChild(e){this.#v.appendChild(e)}}customElements.define("collection-info",p);const g="\n    <style>\n        :host {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: space-evenly;\n            padding: 5%;\n            overflow: auto;\n            align-content: flex-start;\n        }\n    </style>\n";class w extends HTMLElement{#G;#$;#v;constructor(e){super(),this.#$=e;const t=this.attachShadow({mode:"open"});this.#v=t,this.#F(g)}#F(e){this.#v.innerHTML=e}#P(){const e=this.#G.getItemIterator();for(;e.hasMore();){const t=e.getNext(),n=new this.#$(t);this.#v.appendChild(n)}}connectedCallback(){this.isConnected&&this.#P()}disconnectedCallback(){for(let e of this.children)this.#v.removeChild(e)}addController(e){this.#G=e}renderItems(){this.#v.replaceChildren(),this.#F(g),this.#P()}}customElements.define("item-list",w);class b extends HTMLElement{#J;#v;constructor(e){super(),this.#J=e;const t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            position: relative;\n            width: 32%;\n            height: fit-content;\n            cursor: pointer;\n            transition: .3s;\n        }\n        :host(:hover) {\n          scale: 1.2;\n        }\n        #item-img {\n            width: 100%;\n            border-radius: .2rem;\n        }\n    </style>\n",this.#v=t;const n=(new d).of("img").hasIdAs("item-img").build();t.appendChild(n)}connectedCallback(){if(this.isConnected){this.addEventListener("click",(()=>{this.#K(),document.querySelector("item-detail").showItem(this.#J)}));const e=this.#v.querySelector("#item-img");e.srcset=c(this.#J.getAlbumArt()),e.sizes=m(),e.alt=this.#J.getTitle(),e.src=this.#J.getAlbumArt(),e.loading="lazy"}}#K(){document.querySelector("my-music-db").shadowRoot.querySelector("item-list").style.overflow="hidden"}}customElements.define("a-item",b);class C{#Q=[];#u;constructor(e){e&&(this.#Q=e)}setItems(e){this.#Q=e}getItems(){return this.#Q}getItemAt(e){if(e>=this.#Q.length)throw new RangeError("Index out of range");return this.#Q[e]}createIterator(){return new y(this.#Q)}}class y{#U=[];#W=-1;constructor(e){this.#U=e}getCurrentPosition(){return this.#W}getNext(){return this.#W=(this.#W+1)%this.#U.length,this.#U[this.#W]}hasMore(){return this.#W!==this.#U.length-1}}const I={addedOrder:"추가된 순서",artist:"아티스트",recommendation:"추천도",releasedDate:"발매년도"};class x extends HTMLElement{#v;#G;#X;constructor(e,t){super(),this.#G=e;const n=this.attachShadow({mode:"open"});n.innerHTML="\n    <style>\n        :host {\n            width: 100%;\n            height: 10%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            flex-direction: row;\n            border: 2px solid black;\n            box-shadow: 3px 3px black;\n        }\n        #sort-select {\n            margin: 0.5rem;\n            padding: 0.3rem;\n            border-radius: 0.3rem;\n            border: 3px solid black;\n        }\n    </style>\n",this.#v=n,this.#Z(),this.#_(),this.#ee(t)}#Z(){const e=(new d).of("label").for("sort-selected").hasTextOf("SortBy").build();this.#v.appendChild(e)}#_(){const e=(new d).of("select").hasIdAs("sort-select").hasNameOf("sort-select").listeningOn("change",(e=>{this.#X=e.target.value,this.#te(this.#X)})).build();this.#v.appendChild(e)}#te(e){this.#G.sortItemsBy(e),this.#G.renderItemListView()}#ee(e){const t=this.#v.querySelector("#sort-select");for(const n of e){const e=(new d).of("option").hasValueOf(n).hasTextOf(I[n]).build();t.appendChild(e)}}}customElements.define("sort-selection",x),window.onload=()=>{!async function(){try{const n=new t("./src/js/modules/Models/DB/myMusicDB.json"),s=await n.fetchData(),a=await s.json(),{collectionName:d,collectionDescription:c,items:m}=a,g=new o(m,e),y=new p,I=new r({collectionName:d,collectionDescription:c},y);y.addController(I);const T=new C(g.getDeserialized()),R=new w(b),k=new i(T,R);R.addController(k);const A=new x(k,["addedOrder","artist","recommendation","releasedDate"]);y.addCollectionName(),y.addCollectionDescription(),y.addChild(A);const S=new f,O=new h,L=new u;O.addSingleImg(L);const v=new l;S.addChild(y),S.addChild(v),S.addChild(R),document.body.appendChild(S),document.body.appendChild(O)}catch(e){console.error(e)}}()}})();