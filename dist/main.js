(()=>{"use strict";class t{#t;#e;#n;#i;#s;#o;#r=[];#d;#a;#l;constructor(t){this.#l=t.id,this.#a=t.title,this.#t=t.albumArt,this.#e=t.artist,this.#i=t.releasedYear,this.#s=t.recommendation,this.#o=t.genre;for(var e of t.recommendedTracks)this.#r.push(e);this.#d=t}getId(){return this.#l}getTitle(){return this.#a}getAlbumArt(){return this.#t}getArtist(){return this.#e}getReleasedDate(){return this.#i}getRecommendation(){return this.#s}getGenre(){return this.#o}getTracks(){return this.#r}getItemObject(){return this.#d}}class e{#c;#m;#h;constructor(t){t&&(this.#m=t)}fetchData(){return fetch(this.#m)}}const n=["addedOrder","artist","recommendation","genre","releasedDate"];class i{#u;constructor(t){this.#u=t}sortBy(t,e){let n;switch(e){case"addedOrder":n=this.#p(t);break;case"artist":n=this.#g(t);break;case"releasedDate":n=this.#w(t);break;case"recommendation":n=this.#b(t)}return n}#p(t){return t.sort((t,e)=>t.getId()-e.getId())}#g(t){return t.sort((t,e)=>{t=t.getArtist(),e=e.getArtist();return t<e?-1:e<t?1:0})}#w(t){return t.sort((t,e)=>{t=new Date(t.getReleasedDate()),e=new Date(e.getReleasedDate());return t<e?-1:e<t?1:0})}#b(t){const e={strong:10,medium:5,weak:1};return t.sort((t,n)=>{t=t.getRecommendation(),n=n.getRecommendation();return e[t]-e[n]})}}class s{#C;#f;#y;constructor(t,e){this.#C=t,this.#f=e,this.#y=new i(n)}renderItemListView(){this.#f.renderItems()}getItemList(){return this.#C.getItems()}getItemIterator(){return this.#C.createIterator()}sortItemsBy(t){t=this.#y.sortBy(this.#C.getItems(),t);this.#C.setItems(t)}filterBy(t,e){let n,i=this.#C.getItems().slice();return n="genre"===t?this.#x(i,e):n}#x(t,e){return t.filter(t=>t.getGenre()==e)}searchItems(t){for(var e=[],n=this.#C.createIterator();n.hasMore();){var i=n.getNext();let s=!1;(s=t in i.getTitle()?!0:s)&&e.push(i)}return e}}class o{#I;constructor(t,e){if(t){var n=[];for(const i of t)n.push(new e(i));this.#I=n}}getDeserialized(){if(this.#I)return this.#I}}class r{#R;#k;constructor(t,e){this.#k=e,this.#R=t}getCollectionName(){return this.#R.collectionName}getCollectionDescription(){return this.#R.collectionDescription}displayView(){this.#k.display()}}class d{#a;#e;#o;#s;#T;#A;#S;constructor(t){this.#a=t.title,this.#e=t.artist,this.#o=t.genre,this.#s=t.recommendation,this.#T=t.releasedYear,this.#A=t.stream,this.#S=t.recommendedTracks}getTitleText(){return"Title: "+this.#a}getArtistText(){return"Artist: "+this.#e}getGenreText(){return"Genre: "+this.#o}getRecommendationText(){return"Recommendation: "+this.#s}getReleasedYearText(){return"Released Year: "+this.#T}getStreamList(){return Object.entries(this.#A)}getRecommendedTracks(){return this.#S.map(t=>[t.number+". "+t.title,t.playTime])}}class a extends HTMLElement{#E;constructor(){super();var t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            position: absolute;\n            display: block;\n            background-color: black;\n            width: 2px;\n            height: 90%;\n            top: 5%;\n            left: 50%;\n        }\n\n        @media (max-width: 500px) {\n            :host {\n                position: static;\n                display: block;\n                background-color: black;\n                width: 90%;\n                height: 2px;\n            }\n        }\n    </style>\n",this.#E=t,this.setAttribute("id","divider")}}customElements.define("section-divider",a);class l extends HTMLElement{#E;#a;#e;#T;#s;#L;#o;#S;constructor(){super();var t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            display: none;\n            z-index: 1;\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            grid-template-rows: 1fr;\n            grid-template-columns: 1fr 1fr;\n            background-color: white;\n            align-items: center;\n        }\n        #button-back {\n            position: absolute;\n            top: 2.5%;\n            left: 2.5%;\n            width: 5%;\n            height: 5%;\n            border: none;\n            background-color: transparent;\n            background-repeat: no-repeat;\n            cursor: pointer;\n        }\n        #section-info {\n            padding: 0 25%;\n        }\n        #section-info p {\n            font-weight: bolder;\n            font-size: .6rem;\n        }\n        #album-streams {\n            padding: 0;\n        }\n        #album-streams a {\n            font-size: .7rem;\n            text-decoration: none;\n            color: black;\n            border: 1px solid;\n            border-radius: 5px;\n            border-width: medium;\n            padding: 0.2rem;\n            box-shadow: 5px 5px black;\n        }\n        #section-info section #RT-title {\n            font-size: .8rem;\n            font-weight: bolder;\n            margin: 10px 0;\n        }\n        #album-recommendedTracks div {\n            font-size: .7rem;\n        }\n        #album-recommendedTracks div span:nth-child(2) {\n            padding-left: 2.5%;\n        }\n\n        #divider {\n            margin: 0 auto;\n        }\n\n        @media (max-width: 500px) {\n            :host {\n                width: 100vw;\n                height: 100%;\n                grid-template-columns: 1fr;\n                grid-template-rows: 1fr 0 1fr;\n                background-color: white;\n                align-items: center;\n            }\n        }\n    </style>\n",this.#E=t,this.hide=this.hide.bind(this),this.#v(),this.#D(),this.#B()}#v(){var t=document.createElement("button");t.style.backgroundImage="url(./src/assets/images/icons/reshot-icon-angle-back-8E4DS2MACR.svg)",t.setAttribute("id","button-back"),t.addEventListener("click",()=>{this.#M(this.#S),this.#M(this.#L),this.#j(),this.hide()}),this.#E.appendChild(t)}#j(){document.querySelector("my-music-db").shadowRoot.querySelector("item-list").style.overflow="scroll"}#M(t){if(t)for(;t.lastChild;)t.removeChild(t.lastChild)}hide(){this.style.display="none"}display(){this.style.display="grid"}#D(){var t=document.createElement("section"),e=(t.setAttribute("id","section-info"),document.createElement("p")),n=(e.setAttribute("id","album-title"),this.#a=e,document.createElement("p")),i=(n.setAttribute("id","album-artist"),this.#e=n,document.createElement("p")),s=(i.setAttribute("id","album-genre"),this.#o=i,document.createElement("p")),o=(s.setAttribute("id","album-recommendation"),this.#s=s,document.createElement("p")),r=(o.setAttribute("id","album-releaseYear"),this.#T=o,document.createElement("ul")),d=(r.setAttribute("id","album-streams"),this.#L=r,document.createElement("section"));d.setAttribute("id","album-recommendedTracks"),this.#S=d,t.appendChild(e),t.appendChild(n),t.appendChild(i),t.appendChild(s),t.appendChild(o),t.appendChild(r),t.appendChild(d),this.#E.appendChild(t)}showItem(t){this.#O(t.getItemObject()),this.#H(t.getAlbumArt()),this.display()}#O(t){const e=this.#E.querySelector("#section-info");if(this.#M(this.#L),this.#M(this.#S),e){const e=new d(t);this.#a.textContent=e.getTitleText(),this.#e.textContent=e.getArtistText(),this.#o.textContent=e.getGenreText(),this.#s.textContent=e.getRecommendationText(),this.#T.textContent=e.getReleasedYearText();for(const[t,n]of e.getStreamList()){const e=document.createElement("a");e.textContent=t,e.setAttribute("href",n),this.#L.appendChild(e)}var t=document.createElement("p"),i=(t.setAttribute("id","RT-title"),document.createElement("strong"));i.textContent="Recommended Tracks",t.appendChild(i),this.#S.appendChild(t);for(const[t,n]of e.getRecommendedTracks()){const e=document.createElement("div"),i=document.createElement("span"),s=document.createElement("span");i.textContent=t,s.textContent=n,e.appendChild(i),e.appendChild(s),this.#S.appendChild(e)}}}#B(){var t=new a;this.#E.appendChild(t)}#H(t){var e=this.#E.querySelector("#img-container");e&&e.addImg(t)}addSingleImg(t){t&&(t.setAttribute("id","img-container"),this.#E.appendChild(t))}addImgCarousel(t){t&&(t.setAttribute("id","img-container"),this.#E.appendChild(t))}}customElements.define("item-detail",l);const c=t=>{var e=t.lastIndexOf(".");return[t.substring(0,e)+"-small.jpg 300w",t+" 600w"].join(", ")},m=()=>["(max-width: 500px) 300px","600px"].join(", ");class h extends HTMLElement{#V;#z;constructor(t=""){super(),this.#V=t;var t=this.attachShadow({mode:"open"}),n=(t.innerHTML="\n    <style>\n        :host {\n            display: flex;\n            align-items: center;\n            justify-content: center;\n        }\n        #img-content {\n            aspect-ratio: 1 / 1;\n            box-shadow: 5px 5px black;\n            transition: .3s;\n        }\n        #img-content:hover {\n            scale: 1.3;\n        }\n\n        @media (max-width: 500px) {\n            #img-content {\n                width: 75vw;\n            }\n        }\n    </style>\n",document.createElement("img"));n.setAttribute("id","img-content"),this.#z=n,t.appendChild(n)}addImg(t){this.#V=t,this.#z.src=t,this.#z.srcset=c(t),this.#z.sizes=m()}}customElements.define("single-img",h);class u extends HTMLElement{#E;constructor(){super();var t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            width: 100vw;\n            height: 100vh;\n            display: grid;\n            grid-template-rows: 1fr;\n            grid-template-columns: 1fr 1fr;\n        }\n        @media (max-width: 500px) {\n            :host {\n                width: 100vw;\n                height: auto;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                align-items: center;\n            }\n        }\n    </style>\n",this.#E=t}addChild(t){this.#E.appendChild(t)}}customElements.define("my-music-db",u);class p extends HTMLElement{#Y;#E;constructor(){super();var t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            display: block;\n            padding: 5%;\n        }\n    </style>\n",this.#E=t}addCollectionName(){var t=document.createElement("h1");t.setAttribute("id","collection-name"),t.textContent=this.#Y.getCollectionName(),this.#E.appendChild(t)}addCollectionDescription(){var t=document.createElement("p");t.setAttribute("id","collection-description"),t.textContent=this.#Y.getCollectionDescription(),this.#E.appendChild(t)}addController(t){this.#Y=t}display(){this.style.display="block"}addChild(t){this.#E.appendChild(t)}}customElements.define("collection-info",p);const g="\n    <style>\n        :host {\n            display: flex;\n            flex-wrap: wrap;\n            justify-content: space-evenly;\n            padding: 5%;\n            overflow: auto;\n            align-content: flex-start;\n        }\n    </style>\n";class w extends HTMLElement{#N;#q;#E;constructor(t){super(),this.#q=t;t=this.attachShadow({mode:"open"});this.#E=t,this.#G(g)}renderItems(){this.#E.replaceChildren(),this.#G(g),this.#$()}connectedCallback(){this.isConnected&&this.#$()}#G(t){this.#E.innerHTML=t}#$(){for(var t=this.#N.getItemIterator();t.hasMore();){var e=t.getNext(),e=new this.#q(e);this.#E.appendChild(e)}}disconnectedCallback(){for(var t of this.children)this.#E.removeChild(t)}addController(t){this.#N=t}}customElements.define("item-list",w);class b extends HTMLElement{#F;#E;constructor(t){super(),this.#F=t;var t=this.attachShadow({mode:"open"}),n=(t.innerHTML="\n    <style>\n        :host {\n            position: relative;\n            width: 32%;\n            height: fit-content;\n            cursor: pointer;\n            transition: .3s;\n        }\n        :host(:hover) {\n          scale: 1.2;\n        }\n        #item-img {\n            width: 100%;\n            aspect-ratio: 1 / 1;\n            border-radius: .2rem;\n        }\n    </style>\n",this.#E=t,document.createElement("img"));n.setAttribute("id","item-img"),t.appendChild(n)}connectedCallback(){var t;this.isConnected&&(this.addEventListener("click",()=>{this.#P(),document.querySelector("item-detail").showItem(this.#F)}),(t=this.#E.querySelector("#item-img")).srcset=c(this.#F.getAlbumArt()),t.sizes=m(),t.alt=this.#F.getTitle(),t.src=this.#F.getAlbumArt(),t.loading="lazy")}#P(){document.querySelector("my-music-db").shadowRoot.querySelector("item-list").style.overflow="hidden"}}customElements.define("a-item",b);class C{#J=[];#u;constructor(t){t&&(this.#J=t)}setItems(t){this.#J=t}getItems(){return this.#J}getItemAt(t){if(t>=this.#J.length)throw new RangeError("Index out of range");return this.#J[t]}createIterator(){return new f(this.#J)}}class f{#K=[];#Q=-1;constructor(t){this.#K=t}getCurrentPosition(){return this.#Q}getNext(){return this.#Q=(this.#Q+1)%this.#K.length,this.#K[this.#Q]}hasMore(){return this.#Q!==this.#K.length-1}}const y={addedOrder:"추가된 순서",artist:"아티스트",recommendation:"추천도",releasedDate:"발매년도"};class x extends HTMLElement{#E;#N;#U;constructor(t,e){super(),this.#N=t;t=this.attachShadow({mode:"open"});t.innerHTML="\n    <style>\n        :host {\n            display: flex;\n            width: 100%;\n            height: 10%;\n            border: 2px solid black;\n            box-shadow: 3px 3px black;\n            flex-direction: row;\n            align-items: center;\n            justify-content: center;\n        }\n        #sort-select {\n            margin: 0.5rem;\n            padding: 0.3rem;\n            border-radius: 0.3rem;\n            border: 3px solid black;\n        }\n    </style>\n",this.#E=t,this.#W(),this.#X(),this.#Z(e)}#W(){var t=document.createElement("label");t.setAttribute("for","sort-select"),t.textContent="SortBy",this.#E.appendChild(t)}#X(){var t=document.createElement("select");t.setAttribute("id","sort-select"),t.setAttribute("name","sort-select"),t.addEventListener("change",t=>{this.#U=t.target.value,this.#_(this.#U)}),this.#E.appendChild(t)}#_(t){this.#N.sortItemsBy(t),this.#N.renderItemListView()}#Z(t){var e=this.#E.querySelector("#sort-select");for(const n of t){const t=document.createElement("option");t.setAttribute("value",n),t.textContent=y[n],e.appendChild(t)}}}customElements.define("sort-selection",x),window.onload=()=>{!async function(){try{var{collectionName:c,collectionDescription:m,items:g}=await(await new e("./src/javascript/modules/Models/DB/myMusicDB.json").fetchData()).json(),f=new o(g,t),y=new p,I=new r({collectionName:c,collectionDescription:m},y),R=(y.addController(I),new C(f.getDeserialized())),k=new w(b),T=new s(R,k),A=(k.addController(T),new x(T,["addedOrder","artist","recommendation","releasedDate"])),S=(y.addCollectionName(),y.addCollectionDescription(),y.addChild(A),new u),E=new l,L=new h,v=(E.addSingleImg(L),new a);S.addChild(y),S.addChild(v),S.addChild(k),document.body.appendChild(S),document.body.appendChild(E)}catch(t){console.error(t)}}()}})();